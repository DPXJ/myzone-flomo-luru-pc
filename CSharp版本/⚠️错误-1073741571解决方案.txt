╔═══════════════════════════════════════════════════════════╗
║                                                           ║
║     ❌ 错误代码: -1073741571                             ║
║     📋 问题: 缺少运行时组件                              ║
║     ✅ 解决方案如下                                      ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝

🔍 错误分析：

   错误代码: -1073741571 (十六进制: 0xC00000FD)
   
   这个错误表示:
   • 缺少 .NET Desktop Runtime
   • 程序无法加载必要的 DLL 组件
   • WinForms 应用需要额外的运行时支持

═══════════════════════════════════════════════════════════════

✅ 解决方案（选择一个）：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案1: 安装 .NET Desktop Runtime（推荐，最简单）

   这是最快的解决方法！

   【步骤】
   
   1. 双击运行: 🔧安装运行时.bat
   
   2. 脚本会自动使用 winget 安装运行时
      (或者引导您手动下载)
   
   3. 安装完成后重新启动程序
   
   【优点】
   • 最快速（几分钟）
   • 一次安装，永久使用
   • 文件大小约 55 MB

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案2: 重新编译（包含所有依赖）

   修改编译配置，确保包含所有必要的 DLL
   
   【步骤】
   
   1. 双击运行: 🔧修复并重新编译.bat
   
   2. 脚本会使用改进的编译配置重新编译
   
   3. 新版本会包含所有依赖的 DLL 文件
   
   【优点】
   • 真正的自包含程序
   • 不需要安装额外运行时
   • 可以在任何 Windows 10/11 上运行

   【缺点】
   • 文件会更大（150+ MB）
   • 编译需要几分钟

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案3: 手动安装运行时（如果方案1失败）

   【步骤】
   
   1. 访问微软官方网站:
      https://dotnet.microsoft.com/zh-cn/download/dotnet/6.0
   
   2. 在页面中找到 ".NET Desktop Runtime 6.0.x"
   
   3. 选择 "Windows x64" 版本下载
      (文件名类似: windowsdesktop-runtime-6.0.xx-win-x64.exe)
   
   4. 双击下载的文件进行安装
   
   5. 安装完成后重新运行程序

═══════════════════════════════════════════════════════════════

🎯 推荐的操作流程：

   【最快方式】
   
   第1步: 运行 "🔧安装运行时.bat"
          → 等待几分钟安装完成
   
   第2步: 运行程序
          → 双击 "以管理员身份运行.bat"
          → 或直接运行 exe 文件
   
   第3步: 在系统托盘找到图标
          → 屏幕右下角点 "^" 展开
          → 找到 "Flomo快速记录" 图标
          → 右键 → 设置

═══════════════════════════════════════════════════════════════

💡 为什么会出现这个问题？

   技术原因:
   
   • WinForms 应用使用了 Windows 特有的 UI 组件
   • 这些组件依赖 .NET Desktop Runtime
   • 即使编译为"自包含"，某些 WinForms DLL 也需要额外安装
   • 这是 .NET 6 WinForms 的已知限制

   简单来说:
   
   • 控制台程序可以真正自包含
   • GUI 程序（WinForms/WPF）需要 Desktop Runtime

═══════════════════════════════════════════════════════════════

❓ 常见问题：

   Q: 安装运行时会影响我的电脑吗？
   A: 不会。这是微软官方组件，很多软件都需要它。
      安装后其他 .NET 程序也能使用。

   Q: 我不想安装额外软件怎么办？
   A: 使用方案2重新编译，会生成真正自包含的版本。

   Q: 安装后还是不行？
   A: 1. 确认安装的是 Desktop Runtime 而不是 SDK
      2. 重启电脑后再试
      3. 以管理员身份运行程序

   Q: 怎么确认运行时已安装？
   A: 打开命令行，输入: dotnet --list-runtimes
      应该能看到 Microsoft.WindowsDesktop.App 6.0.x

═══════════════════════════════════════════════════════════════

📌 总结：

   最简单的方法 → 运行 "🔧安装运行时.bat"
   
   安装完成后就能正常使用了！

   如果遇到其他问题，请告诉我具体的错误信息。

═══════════════════════════════════════════════════════════════

🚀 下一步：

   立即运行: 🔧安装运行时.bat
   
   或者
   
   立即运行: 🔧修复并重新编译.bat

   两个方案都能解决问题！

═══════════════════════════════════════════════════════════════

