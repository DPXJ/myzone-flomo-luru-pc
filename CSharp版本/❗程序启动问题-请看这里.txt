╔═══════════════════════════════════════════════════════════╗
║                                                           ║
║          ⚠️ 程序启动问题诊断和解决方案                   ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝

📋 当前情况：

   编译成功了，但是程序启动后立即退出，
   在任务栏和系统托盘都看不到图标。

═══════════════════════════════════════════════════════════════

🔍 诊断步骤（按顺序尝试）：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案1: 运行调试脚本（推荐）

   双击运行: 🔍调试启动.bat
   
   这个脚本会:
   ✓ 检查文件是否存在
   ✓ 检查是否已经在运行
   ✓ 直接启动程序并显示可能的错误
   ✓ 如果程序崩溃，会显示错误信息
   
   **请仔细观察脚本的输出，看是否有错误提示！**

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案2: 以管理员身份运行

   很多情况下，程序需要管理员权限才能正常运行
   （特别是注册全局热键）
   
   步骤:
   1. 找到: 以管理员身份运行.bat
   2. 右键 → 以管理员身份运行
   3. 或者直接双击运行

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案3: 直接运行 EXE 文件

   位置: 
   bin\Release\net6.0-windows\win-x64\publish\FlomoQuickNote.exe
   
   操作:
   1. 找到这个文件
   2. 右键 → 以管理员身份运行
   3. 观察是否弹出任何错误提示窗口

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案4: 检查是否已经在运行

   虽然看起来没运行，但可能实际在后台运行
   
   测试方法:
   1. 直接按快捷键 Ctrl+Alt+F
   2. 看是否弹出输入窗口
   3. 如果弹出了，说明程序正在运行

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方案5: 查看任务管理器

   1. 按 Ctrl + Shift + Esc
   2. 在 "进程" 标签中查找 "FlomoQuickNote"
   3. 如果存在，说明程序在运行
      → 去系统托盘找图标（右下角点 "^" 展开）
   4. 如果不存在，说明启动失败
      → 继续下一个方案

═══════════════════════════════════════════════════════════════

❓ 可能的问题和解决方法：

┌─────────────────────────────────────────────────────────┐
│ 问题1: 缺少 .NET 运行时                                 │
│                                                         │
│ 症状: 程序一启动就退出，无任何提示                     │
│                                                         │
│ 解决: 虽然程序应该是自包含的，但可能还是需要           │
│       安装 .NET 6 Desktop Runtime                       │
│                                                         │
│       下载地址:                                         │
│       https://dotnet.microsoft.com/download/dotnet/6.0  │
│       下载 ".NET Desktop Runtime 6.0.x - Windows x64"   │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 问题2: 权限不足                                         │
│                                                         │
│ 症状: 程序无法注册全局热键，启动后立即退出             │
│                                                         │
│ 解决: 以管理员身份运行程序                             │
│       使用 "以管理员身份运行.bat" 脚本                 │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 问题3: 被安全软件拦截                                   │
│                                                         │
│ 症状: 程序无法启动，或启动后立即被关闭                 │
│                                                         │
│ 解决: 将程序添加到安全软件的白名单                     │
│       或临时关闭安全软件测试                           │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 问题4: 配置文件格式错误                                 │
│                                                         │
│ 症状: 程序启动时读取配置出错                           │
│                                                         │
│ 解决: 删除 config.json 文件，让程序重新创建            │
└─────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════

🎯 建议的诊断流程：

   第1步: 双击运行 "🔍调试启动.bat"
          → 仔细观察输出信息
          → 看是否有错误提示

   第2步: 如果看到错误信息
          → 将错误信息告诉我
          → 我会帮你解决

   第3步: 如果没有错误信息
          → 尝试 "以管理员身份运行.bat"

   第4步: 如果还是不行
          → 按 Ctrl+Alt+F 测试快捷键
          → 看是否弹出窗口

═══════════════════════════════════════════════════════════════

💡 快速测试: 程序是否真的没运行？

   方法1: 按 Ctrl+Alt+F
          → 如果弹窗 = 程序正在运行
          → 没反应 = 程序确实没启动

   方法2: 打开任务管理器
          → 查找 FlomoQuickNote.exe
          → 存在 = 运行中
          → 不存在 = 未启动

═══════════════════════════════════════════════════════════════

📌 下一步操作：

   请运行 "🔍调试启动.bat" 
   然后告诉我看到了什么信息！

═══════════════════════════════════════════════════════════════

