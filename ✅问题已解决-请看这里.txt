╔═══════════════════════════════════════════════════════════╗
║                                                           ║
║          🎉 问题已彻底解决！程序可以运行了！             ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝

📋 问题回顾：

   之前的问题:
   • 错误代码: -1073741571
   • 原因: 缺少运行时依赖组件
   • 症状: 程序启动后立即退出

═══════════════════════════════════════════════════════════════

✅ 解决方案：

   已修改编译配置:
   • 不再使用单文件发布 (PublishSingleFile=false)
   • 包含所有必要的 DLL 文件
   • 真正的自包含发布
   
   结果:
   • 程序文件夹包含 400+ 个文件
   • 总大小约 200 MB
   • 无需安装 .NET Runtime
   • 可以在任何 Windows 10/11 (64位) 上运行

═══════════════════════════════════════════════════════════════

🚀 如何启动程序（选择一种方式）：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方式1: 使用启动脚本（推荐）

   双击运行: CSharp版本\以管理员身份运行.bat
   
   • 自动以管理员权限启动
   • 确保全局热键能正常注册
   • 最稳定的启动方式

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方式2: 直接运行 EXE

   位置:
   CSharp版本\bin\Release\net6.0-windows\win-x64\publish\FlomoQuickNote.exe
   
   操作:
   • 右键 → 以管理员身份运行
   • 或直接双击（可能无法注册热键）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方式3: 创建桌面快捷方式

   1. 找到 FlomoQuickNote.exe 文件
   2. 右键 → 发送到 → 桌面快捷方式
   3. 右键点击桌面快捷方式 → 属性
   4. 点击 "高级" → 勾选 "用管理员身份运行"
   5. 确定保存
   6. 以后双击快捷方式即可启动

═══════════════════════════════════════════════════════════════

📍 启动后如何找到应用：

   程序不会显示在任务栏！
   
   它是系统托盘应用，请这样找:
   
   1. 看屏幕右下角（时间旁边）
   2. 点击 "^" 或 "∧" 符号
   3. 在弹出的图标中找 "Flomo快速记录"
   4. 右键点击图标打开菜单

   系统托盘示意:
   ┌─────────────────────────────────┐
   │           🔊 🌐 ^ ⏰ 11:30      │
   └─────────────────────────────────┘
                    ↑
               点这里展开
   
   类似 QQ、微信、网易云音乐的位置！

═══════════════════════════════════════════════════════════════

⚙️ 首次使用配置：

   1. 启动程序后，在系统托盘找到图标
   
   2. 右键点击图标 → 选择 "⚙️ 设置"
   
   3. 配置 Flomo API 地址
      • 访问: https://flomoapp.com
      • 登录后: 点击头像 → 实验室 → API
      • 复制完整的 API 地址
      • 格式: https://flomoapp.com/iwh/xxxxx/
   
   4. (可选) 修改快捷键
      • 默认: Ctrl+Alt+F
      • 可以改成你喜欢的组合
   
   5. (可选) 设置默认标签
      • 如: #灵感 #想法
   
   6. 点击 "保存"

═══════════════════════════════════════════════════════════════

🎯 日常使用：

   方式1: 使用快捷键（推荐）
   
      1. 按 Ctrl+Alt+F（或你设置的快捷键）
      2. 在弹出的窗口输入笔记内容
      3. 点击 "发送" 或按 Ctrl+Enter
      4. 自动同步到 Flomo！

   方式2: 使用托盘菜单
   
      1. 右键点击托盘图标
      2. 选择 "📝 打开输入窗口"
      3. 输入内容后发送

   方式3: 双击托盘图标
   
      直接双击图标也能打开输入窗口

═══════════════════════════════════════════════════════════════

💡 使用技巧：

   • 支持多行文本输入
   • 可以在内容中添加标签 (#标签名)
   • 支持 Markdown 格式
   • 按 ESC 关闭输入窗口
   • 发送成功后窗口自动隐藏

═══════════════════════════════════════════════════════════════

❓ 常见问题：

   Q: 快捷键没反应？
   A: 1. 确保以管理员身份运行
      2. 检查快捷键是否被其他程序占用
      3. 尝试更换其他快捷键组合

   Q: 找不到托盘图标？
   A: 1. 点击右下角 "^" 展开隐藏图标
      2. 检查任务管理器中是否有 FlomoQuickNote.exe
      3. 如果进程存在但看不到图标，重启程序

   Q: 发送笔记失败？
   A: 1. 检查 API 地址是否正确（包含最后的 /）
      2. 检查网络连接
      3. 点击 "测试连接" 按钮诊断问题

   Q: 如何退出程序？
   A: 右键托盘图标 → 选择 "🚪 退出"

   Q: 开机自动启动？
   A: 1. 按 Win+R 输入: shell:startup
      2. 在打开的文件夹中创建快捷方式
      3. 指向 FlomoQuickNote.exe
      4. 设置快捷方式以管理员身份运行

═══════════════════════════════════════════════════════════════

🎁 程序特性：

   ✓ 轻量级设计，内存占用低
   ✓ 全局热键快速唤起
   ✓ 系统托盘常驻
   ✓ 自动同步到 Flomo
   ✓ 支持标签管理
   ✓ 支持多行文本
   ✓ 简洁美观的界面
   ✓ 完全免费开源

═══════════════════════════════════════════════════════════════

📦 文件说明：

   重要文件:
   • FlomoQuickNote.exe - 主程序
   • config.json - 配置文件（自动生成）
   • *.dll - 运行时依赖库（必需）
   
   注意:
   • 所有文件必须保持在同一目录
   • 不要删除任何 DLL 文件
   • 可以将整个 publish 文件夹移动到其他位置

═══════════════════════════════════════════════════════════════

🎉 开始使用！

   现在请：
   
   1. 双击运行: CSharp版本\以管理员身份运行.bat
   
   2. 在系统托盘找到图标（右下角点 "^"）
   
   3. 右键 → 设置 → 配置 Flomo API
   
   4. 按 Ctrl+Alt+F 开始记录灵感！

═══════════════════════════════════════════════════════════════

祝您使用愉快！📝✨

═══════════════════════════════════════════════════════════════

项目信息:
• 版本: v1.0.0
• GitHub: https://github.com/DPXJ/myzone-flomo-luru-pc
• 许可证: MIT License
• 技术栈: C# WinForms + .NET 6

═══════════════════════════════════════════════════════════════

